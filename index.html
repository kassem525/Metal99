<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>حاسبة وزن لوح معدني</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="jspdf.umd.min.js"></script>
  <style>
    body {{
      font-family: 'Segoe UI', Tahoma, sans-serif;
      background: #f8f9fa;
      direction: rtl;
      padding: 20px;
    }}
    .calculator {{
      background: white;
      border-radius: 12px;
      padding: 20px;
      max-width: 400px;
      margin: auto;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }}
    input, select, button {{
      width: 100%;
      padding: 10px;
      margin: 8px 0;
      font-size: 16px;
    }}
    #savedResults div {{
      margin-bottom: 5px;
    }}
    button.small-btn {{
      font-size: 13px;
      padding: 3px 6px;
    }}
  </style>
</head>
<body>
  <div class="calculator">
    <h2>حاسبة وزن لوح معدني</h2>
    <label>الطول (سم):</label><input type="number" id="length" />
    <label>العرض (سم):</label><input type="number" id="width" />
    <label>السماكة (سم):</label><input type="number" id="thickness" />
    <label>نوع المعدن:</label>
    <select id="material">
      <option value="7.85">حديد</option>
      <option value="2.70">ألمنيوم</option>
      <option value="8.96">نحاس</option>
    </select>
    <label>عدد النسخ:</label><input type="number" id="multiplyInput" />
    <button id="calculateBtn">احسب الوزن</button>
    <h3 id="result">الوزن: ... كجم</h3>
    <button id="addResultBtn">➕ إضافة</button>
    <div id="savedResults"></div>
    <h3 id="totalSum">المجموع: 0.00 كجم</h3>
    <button id="exportPdfBtn">📄 تصدير PDF</button>
  </div>

  <script>
    let currentWeight = 0;
    let totalSum = 0;

    document.getElementById("calculateBtn").onclick = () => {{
      const length = parseFloat(document.getElementById('length').value);
      const width = parseFloat(document.getElementById('width').value);
      const thickness = parseFloat(document.getElementById('thickness').value);
      const density = parseFloat(document.getElementById('material').value);

      if (isNaN(length) || isNaN(width) || isNaN(thickness)) {{
        alert("يرجى إدخال القيم بشكل صحيح");
        return;
      }}

      const volume = length * width * thickness;
      currentWeight = (volume * density) / 1000;
      const multiplier = parseFloat(document.getElementById('multiplyInput').value);
      const total = isNaN(multiplier) ? currentWeight : currentWeight * multiplier;
      document.getElementById("result").textContent = `الوزن: ${{total.toFixed(2)}} كجم`;
    }};

    document.getElementById("addResultBtn").onclick = () => {{
      const thickness = document.getElementById('thickness').value;
      const length = document.getElementById('length').value;
      const multiplier = document.getElementById('multiplyInput').value;
      const multiplied = (currentWeight * multiplier).toFixed(3);
      if (isNaN(multiplied) || multiplied <= 0) {{
        alert("لا توجد بيانات صالحة للإضافة");
        return;
      }}
      const resultId = Date.now();
      const resultText = `السماكة ${{thickness}} × الطول ${{length}} × العدد ${{multiplier}} = ${{multiplied}} كجم`;
      const div = document.createElement("div");
      div.id = `result-${{resultId}}`;
      div.innerHTML = `<span>${{resultText}}</span> <button class='small-btn' onclick="removeResult(${{multiplied}}, 'result-${{resultId}}')">حذف</button>`;
      document.getElementById("savedResults").appendChild(div);
      totalSum += parseFloat(multiplied);
      document.getElementById("totalSum").textContent = `المجموع: ${{totalSum.toFixed(3)}} كجم`;
    }};

    function removeResult(value, id) {{
      totalSum -= value;
      document.getElementById("totalSum").textContent = `المجموع: ${{totalSum.toFixed(3)}} كجم`;
      const el = document.getElementById(id);
      if (el) el.remove();
    }}
  </script>
</body>
</html>